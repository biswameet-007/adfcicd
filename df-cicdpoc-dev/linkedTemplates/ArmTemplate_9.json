{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "df-cicdpoc-dev"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/dp_Workorder_Dim_df')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "srcStgWorkorder",
								"type": "DatasetReference"
							},
							"name": "srcStgWorkorderRd"
						},
						{
							"dataset": {
								"referenceName": "OrgSiteRefRd1",
								"type": "DatasetReference"
							},
							"name": "OrgSiteRef"
						},
						{
							"dataset": {
								"referenceName": "OrgSiteRefRd1",
								"type": "DatasetReference"
							},
							"name": "LocationRef"
						},
						{
							"dataset": {
								"referenceName": "OrgSiteRefRd1",
								"type": "DatasetReference"
							},
							"name": "MAXKEY"
						},
						{
							"dataset": {
								"referenceName": "OrgSiteRefRd1",
								"type": "DatasetReference"
							},
							"name": "ExistingRecords"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "SinkWorkorder",
								"type": "DatasetReference"
							},
							"name": "sinkInsertWorkorder"
						},
						{
							"dataset": {
								"referenceName": "SinkWorkorder",
								"type": "DatasetReference"
							},
							"name": "sinkUpdateWorkorder"
						}
					],
					"transformations": [
						{
							"name": "lkpOrgSite"
						},
						{
							"name": "lkpLocation"
						},
						{
							"name": "selExistingRecords"
						},
						{
							"name": "dCNewHashKey"
						},
						{
							"name": "existsWorkorder"
						},
						{
							"name": "lkpExistWo"
						},
						{
							"name": "NewItem"
						},
						{
							"name": "joinMaxKey"
						},
						{
							"name": "skWo"
						},
						{
							"name": "dcInsertWo"
						},
						{
							"name": "selInsertWo"
						},
						{
							"name": "dcUpdateWo"
						},
						{
							"name": "selUpdateWo"
						},
						{
							"name": "alterRowUpdate"
						}
					],
					"scriptLines": [
						"source(output(",
						"          WONUM as string,",
						"          PARENT as string,",
						"          GOVTWONUM as string,",
						"          ORGID as string,",
						"          SITEID as string,",
						"          LOCATION as string,",
						"          ASSETNUM as string,",
						"          STATUS as string,",
						"          JPNUM as string,",
						"          WORKTYPE as string,",
						"          TASKID as integer,",
						"          ISTASK as integer,",
						"          DESCRIPTION as string,",
						"          PLUSCJPREVNUM as integer,",
						"          WOPRIORITY as integer,",
						"          CHANGEDATE as timestamp,",
						"          STATUSDATE as timestamp,",
						"          CHANGEBY as string,",
						"          PMDUEDATE as date,",
						"          TARGSTARTDATE as timestamp,",
						"          TARGCOMPDATE as timestamp,",
						"          REPORTDATE as timestamp,",
						"          RESPONDBY as timestamp,",
						"          ACTLABHRS as decimal(18,9),",
						"          ACTSTART as timestamp,",
						"          ACTFINISH as timestamp,",
						"          ACTINTLABHRS as decimal(18,9),",
						"          ESTDUR as decimal(18,9),",
						"          WOGROUP as string,",
						"          PERSONGROUP as string,",
						"          OWNERGROUP as string,",
						"          PLUSCFREQUENCY as integer,",
						"          PLUSCFREQUNIT as string,",
						"          PMNEXTDUEDATE as date,",
						"          PMNUM as string,",
						"          ENTRY_DT as timestamp,",
						"          WO_ID as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table',",
						"     staged: true) ~> srcStgWorkorderRd",
						"source(output(",
						"          ORGANIZATION_ID as integer,",
						"          ORGANIZATION_NM as string,",
						"          SITE_ID as integer,",
						"          SITE_NM as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT O.ORGANIZATION_ID AS ORGANIZATION_ID,O.ORGANIZATION_NM AS ORGANIZATION_NM, S.SITE_ID AS SITE_ID,S.SITE_NM AS SITE_NM\\nFROM MXMDW.ORGANIZATION O,\\nMXMDW.SITE S\\nWHERE O.ORGANIZATION_ID = S.ORGANIZATION_ID',",
						"     format: 'query',",
						"     staged: true) ~> OrgSiteRef",
						"source(output(",
						"          LOCATION_ID as integer,",
						"          DIM_LOCATION as string,",
						"          LOCATION_DESC as string,",
						"          LOC_SITE_NM as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT L.LOCATION_ID AS LOCATION_ID,L.LOCATION AS DIM_LOCATION,L.DESCRIPTION AS LOCATION_DESC, S.SITE_NM AS LOC_SITE_NM\\nFROM MXMDW.LOCATIONS L\\nINNER JOIN MXMDW.SITE S\\nON S.SITE_ID = L.SITE_ID',",
						"     format: 'query',",
						"     staged: true) ~> LocationRef",
						"source(output(",
						"          MAXKEY as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT MAXKEY=ISNULL(MAX(WORKORDER_ID),0) FROM  MXMDW.WORKORDER',",
						"     format: 'query',",
						"     staged: true) ~> MAXKEY",
						"source(output(",
						"          WORKORDER_ID as integer,",
						"          WONUM as string,",
						"          PARENT as string,",
						"          SITE_ID as integer,",
						"          STATUS as string,",
						"          STATUSDATE as timestamp,",
						"          SRC_TYPE_HASH_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT WORKORDER_ID,WONUM,PARENT,SITE_ID,STATUS,STATUSDATE,SRC_TYPE_HASH_KEY FROM MXMDW.WORKORDER',",
						"     format: 'query',",
						"     staged: true) ~> ExistingRecords",
						"srcStgWorkorderRd, OrgSiteRef lookup(ORGID == ORGANIZATION_NM",
						"     && SITEID == SITE_NM,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lkpOrgSite",
						"lkpOrgSite, LocationRef lookup(LOCATION == DIM_LOCATION",
						"     && SITEID == LOC_SITE_NM,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lkpLocation",
						"ExistingRecords select(mapColumn(",
						"          ExistWORKORDER_ID = WORKORDER_ID,",
						"          ExistWONUM = WONUM,",
						"          ExistPARENT = PARENT,",
						"          ExistSITE_ID = SITE_ID,",
						"          ExistSTATUS = STATUS,",
						"          ExistSTATUSDATE = STATUSDATE,",
						"          ExistSRC_TYPE_HASH_KEY = SRC_TYPE_HASH_KEY",
						"     ),",
						"     partitionBy('hash', 1),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selExistingRecords",
						"lkpLocation derive(SRC_TYPE_HASH_KEY = sha2(256,WONUM,PARENT,SITE_ID,STATUS,STATUSDATE,CHANGEDATE),",
						"          LOCATION_ID = iifNull(LOCATION_ID, toInteger(-1), LOCATION_ID)) ~> dCNewHashKey",
						"dCNewHashKey, selExistingRecords exists(WONUM == ExistWONUM",
						"     && SITE_ID == ExistSITE_ID",
						"     && SRC_TYPE_HASH_KEY == ExistSRC_TYPE_HASH_KEY,",
						"     negate:true,",
						"     partitionBy('hash', 1),",
						"     broadcast: 'right')~> existsWorkorder",
						"existsWorkorder, selExistingRecords lookup(WONUM == ExistWONUM",
						"     && SITE_ID == ExistSITE_ID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     partitionBy('hash', 1),",
						"     broadcast: 'auto')~> lkpExistWo",
						"lkpExistWo split(isNull(ExistWORKORDER_ID),",
						"     disjoint: false,",
						"     partitionBy('hash', 1)) ~> NewItem@(NewItem, UpdateItem)",
						"NewItem@NewItem, MAXKEY join(1==1,",
						"     joinType:'cross',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     partitionBy('hash', 1),",
						"     broadcast: 'auto')~> joinMaxKey",
						"joinMaxKey keyGenerate(output(NewWORKORDER_ID as long),",
						"     startAt: 1L,",
						"     stepValue: 1L) ~> skWo",
						"skWo derive(WORKORDER_ID = MAXKEY + NewWORKORDER_ID,",
						"          EFFECTIVE_DT = currentTimestamp(),",
						"          LOCATION_ID = iifNull(LOCATION_ID, toInteger(-1), LOCATION_ID)) ~> dcInsertWo",
						"dcInsertWo select(mapColumn(",
						"          WONUM,",
						"          PARENT,",
						"          GOVTWONUM,",
						"          ORGANIZATION_ID,",
						"          SITE_ID,",
						"          LOCATION_ID,",
						"          ASSETNUM,",
						"          STATUS,",
						"          JPNUM,",
						"          WORKTYPE,",
						"          TASKID,",
						"          ISTASK,",
						"          DESCRIPTION,",
						"          PLUSCJPREVNUM,",
						"          WOPRIORITY,",
						"          CHANGEDATE,",
						"          STATUSDATE,",
						"          CHANGEBY,",
						"          PMDUEDATE,",
						"          TARGSTARTDATE,",
						"          TARGCOMPDATE,",
						"          REPORTDATE,",
						"          RESPONDBY,",
						"          ACTLABHRS,",
						"          ACTSTART,",
						"          ACTFINISH,",
						"          ACTINTLABHRS,",
						"          ESTDUR,",
						"          WOGROUP,",
						"          PERSONGROUP,",
						"          OWNERGROUP,",
						"          PLUSCFREQUENCY,",
						"          PLUSCFREQUNIT,",
						"          PMNEXTDUEDATE,",
						"          PMNUM,",
						"          EFFECTIVE_DT,",
						"          WORKORDER_ID,",
						"          SRC_TYPE_HASH_KEY",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selInsertWo",
						"NewItem@UpdateItem derive(EFFECTIVE_DT = currentTimestamp()) ~> dcUpdateWo",
						"dcUpdateWo select(mapColumn(",
						"          WONUM,",
						"          PARENT,",
						"          GOVTWONUM,",
						"          ORGANIZATION_ID,",
						"          SITE_ID,",
						"          LOCATION_ID,",
						"          ASSETNUM,",
						"          STATUS,",
						"          JPNUM,",
						"          WORKTYPE,",
						"          TASKID,",
						"          ISTASK,",
						"          DESCRIPTION,",
						"          PLUSCJPREVNUM,",
						"          WOPRIORITY,",
						"          CHANGEDATE,",
						"          STATUSDATE,",
						"          CHANGEBY,",
						"          PMDUEDATE,",
						"          TARGSTARTDATE,",
						"          TARGCOMPDATE,",
						"          REPORTDATE,",
						"          RESPONDBY,",
						"          ACTLABHRS,",
						"          ACTSTART,",
						"          ACTFINISH,",
						"          ACTINTLABHRS,",
						"          ESTDUR,",
						"          WOGROUP,",
						"          PERSONGROUP,",
						"          OWNERGROUP,",
						"          PLUSCFREQUENCY,",
						"          PLUSCFREQUNIT,",
						"          PMNEXTDUEDATE,",
						"          PMNUM,",
						"          EFFECTIVE_DT,",
						"          SRC_TYPE_HASH_KEY,",
						"          ExistWORKORDER_ID,",
						"          ExistWONUM,",
						"          ExistSITE_ID",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selUpdateWo",
						"selUpdateWo alterRow(updateIf(1==1)) ~> alterRowUpdate",
						"selInsertWo sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          WORKORDER_ID as integer,",
						"          WONUM as string,",
						"          PARENT as string,",
						"          GOVTWONUM as string,",
						"          ORGANIZATION_ID as integer,",
						"          SITE_ID as integer,",
						"          LOCATION_ID as integer,",
						"          ASSETNUM as string,",
						"          STATUS as string,",
						"          JPNUM as string,",
						"          WORKTYPE as string,",
						"          TASKID as integer,",
						"          ISTASK as integer,",
						"          DESCRIPTION as string,",
						"          PLUSCJPREVNUM as integer,",
						"          WOPRIORITY as integer,",
						"          CHANGEDATE as timestamp,",
						"          STATUSDATE as timestamp,",
						"          CHANGEBY as string,",
						"          PMDUEDATE as date,",
						"          TARGSTARTDATE as timestamp,",
						"          TARGCOMPDATE as timestamp,",
						"          REPORTDATE as timestamp,",
						"          RESPONDBY as timestamp,",
						"          ACTLABHRS as decimal(18,9),",
						"          ACTSTART as timestamp,",
						"          ACTFINISH as timestamp,",
						"          ACTINTLABHRS as decimal(18,9),",
						"          ESTDUR as decimal(18,9),",
						"          WOGROUP as string,",
						"          PERSONGROUP as string,",
						"          OWNERGROUP as string,",
						"          PLUSCFREQUENCY as integer,",
						"          PLUSCFREQUNIT as string,",
						"          PMNEXTDUEDATE as date,",
						"          PMNUM as string,",
						"          EFFECTIVE_DT as timestamp,",
						"          SRC_TYPE_HASH_KEY as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 2,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          WORKORDER_ID,",
						"          WONUM,",
						"          PARENT,",
						"          GOVTWONUM,",
						"          ORGANIZATION_ID,",
						"          SITE_ID,",
						"          LOCATION_ID,",
						"          ASSETNUM,",
						"          STATUS,",
						"          JPNUM,",
						"          WORKTYPE,",
						"          TASKID,",
						"          ISTASK,",
						"          DESCRIPTION,",
						"          PLUSCJPREVNUM,",
						"          WOPRIORITY,",
						"          CHANGEDATE,",
						"          STATUSDATE,",
						"          CHANGEBY,",
						"          PMDUEDATE,",
						"          TARGSTARTDATE,",
						"          TARGCOMPDATE,",
						"          REPORTDATE,",
						"          RESPONDBY,",
						"          ACTLABHRS,",
						"          ACTSTART,",
						"          ACTFINISH,",
						"          ACTINTLABHRS,",
						"          ESTDUR,",
						"          WOGROUP,",
						"          PERSONGROUP,",
						"          OWNERGROUP,",
						"          PLUSCFREQUENCY,",
						"          PLUSCFREQUNIT,",
						"          PMNEXTDUEDATE,",
						"          PMNUM,",
						"          EFFECTIVE_DT,",
						"          SRC_TYPE_HASH_KEY",
						"     )) ~> sinkInsertWorkorder",
						"alterRowUpdate sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          WORKORDER_ID as integer,",
						"          WONUM as string,",
						"          PARENT as string,",
						"          GOVTWONUM as string,",
						"          ORGANIZATION_ID as integer,",
						"          SITE_ID as integer,",
						"          LOCATION_ID as integer,",
						"          ASSETNUM as string,",
						"          STATUS as string,",
						"          JPNUM as string,",
						"          WORKTYPE as string,",
						"          TASKID as integer,",
						"          ISTASK as integer,",
						"          DESCRIPTION as string,",
						"          PLUSCJPREVNUM as integer,",
						"          WOPRIORITY as integer,",
						"          CHANGEDATE as timestamp,",
						"          STATUSDATE as timestamp,",
						"          CHANGEBY as string,",
						"          PMDUEDATE as date,",
						"          TARGSTARTDATE as timestamp,",
						"          TARGCOMPDATE as timestamp,",
						"          REPORTDATE as timestamp,",
						"          RESPONDBY as timestamp,",
						"          ACTLABHRS as decimal(18,9),",
						"          ACTSTART as timestamp,",
						"          ACTFINISH as timestamp,",
						"          ACTINTLABHRS as decimal(18,9),",
						"          ESTDUR as decimal(18,9),",
						"          WOGROUP as string,",
						"          PERSONGROUP as string,",
						"          OWNERGROUP as string,",
						"          PLUSCFREQUENCY as integer,",
						"          PLUSCFREQUNIT as string,",
						"          PMNEXTDUEDATE as date,",
						"          PMNUM as string,",
						"          EFFECTIVE_DT as timestamp,",
						"          SRC_TYPE_HASH_KEY as string",
						"     ),",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:true,",
						"     upsertable:false,",
						"     keys:['WONUM','SITE_ID'],",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          WORKORDER_ID = ExistWORKORDER_ID,",
						"          WONUM = ExistWONUM,",
						"          PARENT,",
						"          GOVTWONUM,",
						"          ORGANIZATION_ID,",
						"          SITE_ID = ExistSITE_ID,",
						"          LOCATION_ID,",
						"          ASSETNUM,",
						"          STATUS,",
						"          JPNUM,",
						"          WORKTYPE,",
						"          TASKID,",
						"          ISTASK,",
						"          DESCRIPTION,",
						"          PLUSCJPREVNUM,",
						"          WOPRIORITY,",
						"          CHANGEDATE,",
						"          STATUSDATE,",
						"          CHANGEBY,",
						"          PMDUEDATE,",
						"          TARGSTARTDATE,",
						"          TARGCOMPDATE,",
						"          REPORTDATE,",
						"          RESPONDBY,",
						"          ACTLABHRS,",
						"          ACTSTART,",
						"          ACTFINISH,",
						"          ACTINTLABHRS,",
						"          ESTDUR,",
						"          WOGROUP,",
						"          PERSONGROUP,",
						"          OWNERGROUP,",
						"          PLUSCFREQUENCY,",
						"          PLUSCFREQUNIT,",
						"          PMNEXTDUEDATE,",
						"          PMNUM,",
						"          EFFECTIVE_DT,",
						"          SRC_TYPE_HASH_KEY",
						"     )) ~> sinkUpdateWorkorder"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Workorder_Dim_df1')]",
			"type": "Microsoft.DataFactory/factories/dataflows",
			"apiVersion": "2018-06-01",
			"properties": {
				"type": "MappingDataFlow",
				"typeProperties": {
					"sources": [
						{
							"dataset": {
								"referenceName": "srcStgWorkorder1",
								"type": "DatasetReference"
							},
							"name": "srcStgWorkorderRd"
						},
						{
							"dataset": {
								"referenceName": "OrgSiteRefRd11",
								"type": "DatasetReference"
							},
							"name": "OrgSiteRef"
						},
						{
							"dataset": {
								"referenceName": "OrgSiteRefRd11",
								"type": "DatasetReference"
							},
							"name": "LocationRef"
						},
						{
							"dataset": {
								"referenceName": "OrgSiteRefRd11",
								"type": "DatasetReference"
							},
							"name": "MAXKEY"
						},
						{
							"dataset": {
								"referenceName": "OrgSiteRefRd11",
								"type": "DatasetReference"
							},
							"name": "ExistingRecords"
						}
					],
					"sinks": [
						{
							"dataset": {
								"referenceName": "SinkWorkorder1",
								"type": "DatasetReference"
							},
							"name": "sinkInsertWorkorder"
						},
						{
							"dataset": {
								"referenceName": "SinkWorkorder1",
								"type": "DatasetReference"
							},
							"name": "sinkUpdateWorkorder"
						}
					],
					"transformations": [
						{
							"name": "lkpOrgSite"
						},
						{
							"name": "lkpLocation"
						},
						{
							"name": "selExistingRecords"
						},
						{
							"name": "dCNewHashKey"
						},
						{
							"name": "existsWorkorder"
						},
						{
							"name": "lkpExistWo"
						},
						{
							"name": "NewItem"
						},
						{
							"name": "joinMaxKey"
						},
						{
							"name": "skWo"
						},
						{
							"name": "dcInsertWo"
						},
						{
							"name": "selInsertWo"
						},
						{
							"name": "dcUpdateWo"
						},
						{
							"name": "selUpdateWo"
						},
						{
							"name": "alterRowUpdate"
						}
					],
					"scriptLines": [
						"source(output(",
						"          WONUM as string,",
						"          PARENT as string,",
						"          GOVTWONUM as string,",
						"          ORGID as string,",
						"          SITEID as string,",
						"          LOCATION as string,",
						"          ASSETNUM as string,",
						"          STATUS as string,",
						"          JPNUM as string,",
						"          WORKTYPE as string,",
						"          TASKID as integer,",
						"          ISTASK as integer,",
						"          DESCRIPTION as string,",
						"          PLUSCJPREVNUM as integer,",
						"          WOPRIORITY as integer,",
						"          CHANGEDATE as timestamp,",
						"          STATUSDATE as timestamp,",
						"          CHANGEBY as string,",
						"          PMDUEDATE as date,",
						"          TARGSTARTDATE as timestamp,",
						"          TARGCOMPDATE as timestamp,",
						"          REPORTDATE as timestamp,",
						"          RESPONDBY as timestamp,",
						"          ACTLABHRS as decimal(18,9),",
						"          ACTSTART as timestamp,",
						"          ACTFINISH as timestamp,",
						"          ACTINTLABHRS as decimal(18,9),",
						"          ESTDUR as decimal(18,9),",
						"          WOGROUP as string,",
						"          PERSONGROUP as string,",
						"          OWNERGROUP as string,",
						"          PLUSCFREQUENCY as integer,",
						"          PLUSCFREQUNIT as string,",
						"          PMNEXTDUEDATE as date,",
						"          PMNUM as string,",
						"          ENTRY_DT as timestamp,",
						"          WO_ID as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     format: 'table',",
						"     staged: true) ~> srcStgWorkorderRd",
						"source(output(",
						"          ORGANIZATION_ID as integer,",
						"          ORGANIZATION_NM as string,",
						"          SITE_ID as integer,",
						"          SITE_NM as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT O.ORGANIZATION_ID AS ORGANIZATION_ID,O.ORGANIZATION_NM AS ORGANIZATION_NM, S.SITE_ID AS SITE_ID,S.SITE_NM AS SITE_NM\\nFROM MXMDW.ORGANIZATION O,\\nMXMDW.SITE S\\nWHERE O.ORGANIZATION_ID = S.ORGANIZATION_ID',",
						"     format: 'query',",
						"     staged: true) ~> OrgSiteRef",
						"source(output(",
						"          LOCATION_ID as integer,",
						"          DIM_LOCATION as string,",
						"          LOCATION_DESC as string,",
						"          LOC_SITE_NM as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT L.LOCATION_ID AS LOCATION_ID,L.LOCATION AS DIM_LOCATION,L.DESCRIPTION AS LOCATION_DESC, S.SITE_NM AS LOC_SITE_NM\\nFROM MXMDW.LOCATIONS L\\nINNER JOIN MXMDW.SITE S\\nON S.SITE_ID = L.SITE_ID',",
						"     format: 'query',",
						"     staged: true) ~> LocationRef",
						"source(output(",
						"          MAXKEY as integer",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT MAXKEY=ISNULL(MAX(WORKORDER_ID),0) FROM  MXMDW.WORKORDER',",
						"     format: 'query',",
						"     staged: true) ~> MAXKEY",
						"source(output(",
						"          WORKORDER_ID as integer,",
						"          WONUM as string,",
						"          PARENT as string,",
						"          SITE_ID as integer,",
						"          STATUS as string,",
						"          STATUSDATE as timestamp,",
						"          SRC_TYPE_HASH_KEY as string",
						"     ),",
						"     allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     isolationLevel: 'READ_UNCOMMITTED',",
						"     query: 'SELECT WORKORDER_ID,WONUM,PARENT,SITE_ID,STATUS,STATUSDATE,SRC_TYPE_HASH_KEY FROM MXMDW.WORKORDER',",
						"     format: 'query',",
						"     staged: true) ~> ExistingRecords",
						"srcStgWorkorderRd, OrgSiteRef lookup(ORGID == ORGANIZATION_NM",
						"     && SITEID == SITE_NM,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lkpOrgSite",
						"lkpOrgSite, LocationRef lookup(LOCATION == DIM_LOCATION",
						"     && SITEID == LOC_SITE_NM,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     broadcast: 'auto')~> lkpLocation",
						"ExistingRecords select(mapColumn(",
						"          ExistWORKORDER_ID = WORKORDER_ID,",
						"          ExistWONUM = WONUM,",
						"          ExistPARENT = PARENT,",
						"          ExistSITE_ID = SITE_ID,",
						"          ExistSTATUS = STATUS,",
						"          ExistSTATUSDATE = STATUSDATE,",
						"          ExistSRC_TYPE_HASH_KEY = SRC_TYPE_HASH_KEY",
						"     ),",
						"     partitionBy('hash', 1),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selExistingRecords",
						"lkpLocation derive(SRC_TYPE_HASH_KEY = sha2(256,WONUM,PARENT,SITE_ID,STATUS,STATUSDATE,CHANGEDATE),",
						"          LOCATION_ID = iifNull(LOCATION_ID, toInteger(-1), LOCATION_ID)) ~> dCNewHashKey",
						"dCNewHashKey, selExistingRecords exists(WONUM == ExistWONUM",
						"     && SITE_ID == ExistSITE_ID",
						"     && SRC_TYPE_HASH_KEY == ExistSRC_TYPE_HASH_KEY,",
						"     negate:true,",
						"     partitionBy('hash', 1),",
						"     broadcast: 'right')~> existsWorkorder",
						"existsWorkorder, selExistingRecords lookup(WONUM == ExistWONUM",
						"     && SITE_ID == ExistSITE_ID,",
						"     multiple: false,",
						"     pickup: 'any',",
						"     partitionBy('hash', 1),",
						"     broadcast: 'auto')~> lkpExistWo",
						"lkpExistWo split(isNull(ExistWORKORDER_ID),",
						"     disjoint: false,",
						"     partitionBy('hash', 1)) ~> NewItem@(NewItem, UpdateItem)",
						"NewItem@NewItem, MAXKEY join(1==1,",
						"     joinType:'cross',",
						"     matchType:'exact',",
						"     ignoreSpaces: false,",
						"     partitionBy('hash', 1),",
						"     broadcast: 'auto')~> joinMaxKey",
						"joinMaxKey keyGenerate(output(NewWORKORDER_ID as long),",
						"     startAt: 1L,",
						"     stepValue: 1L) ~> skWo",
						"skWo derive(WORKORDER_ID = MAXKEY + NewWORKORDER_ID,",
						"          EFFECTIVE_DT = currentTimestamp(),",
						"          LOCATION_ID = iifNull(LOCATION_ID, toInteger(-1), LOCATION_ID)) ~> dcInsertWo",
						"dcInsertWo select(mapColumn(",
						"          WONUM,",
						"          PARENT,",
						"          GOVTWONUM,",
						"          ORGANIZATION_ID,",
						"          SITE_ID,",
						"          LOCATION_ID,",
						"          ASSETNUM,",
						"          STATUS,",
						"          JPNUM,",
						"          WORKTYPE,",
						"          TASKID,",
						"          ISTASK,",
						"          DESCRIPTION,",
						"          PLUSCJPREVNUM,",
						"          WOPRIORITY,",
						"          CHANGEDATE,",
						"          STATUSDATE,",
						"          CHANGEBY,",
						"          PMDUEDATE,",
						"          TARGSTARTDATE,",
						"          TARGCOMPDATE,",
						"          REPORTDATE,",
						"          RESPONDBY,",
						"          ACTLABHRS,",
						"          ACTSTART,",
						"          ACTFINISH,",
						"          ACTINTLABHRS,",
						"          ESTDUR,",
						"          WOGROUP,",
						"          PERSONGROUP,",
						"          OWNERGROUP,",
						"          PLUSCFREQUENCY,",
						"          PLUSCFREQUNIT,",
						"          PMNEXTDUEDATE,",
						"          PMNUM,",
						"          EFFECTIVE_DT,",
						"          WORKORDER_ID,",
						"          SRC_TYPE_HASH_KEY",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selInsertWo",
						"NewItem@UpdateItem derive(EFFECTIVE_DT = currentTimestamp()) ~> dcUpdateWo",
						"dcUpdateWo select(mapColumn(",
						"          WONUM,",
						"          PARENT,",
						"          GOVTWONUM,",
						"          ORGANIZATION_ID,",
						"          SITE_ID,",
						"          LOCATION_ID,",
						"          ASSETNUM,",
						"          STATUS,",
						"          JPNUM,",
						"          WORKTYPE,",
						"          TASKID,",
						"          ISTASK,",
						"          DESCRIPTION,",
						"          PLUSCJPREVNUM,",
						"          WOPRIORITY,",
						"          CHANGEDATE,",
						"          STATUSDATE,",
						"          CHANGEBY,",
						"          PMDUEDATE,",
						"          TARGSTARTDATE,",
						"          TARGCOMPDATE,",
						"          REPORTDATE,",
						"          RESPONDBY,",
						"          ACTLABHRS,",
						"          ACTSTART,",
						"          ACTFINISH,",
						"          ACTINTLABHRS,",
						"          ESTDUR,",
						"          WOGROUP,",
						"          PERSONGROUP,",
						"          OWNERGROUP,",
						"          PLUSCFREQUENCY,",
						"          PLUSCFREQUNIT,",
						"          PMNEXTDUEDATE,",
						"          PMNUM,",
						"          EFFECTIVE_DT,",
						"          SRC_TYPE_HASH_KEY,",
						"          ExistWORKORDER_ID,",
						"          ExistWONUM,",
						"          ExistSITE_ID",
						"     ),",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true) ~> selUpdateWo",
						"selUpdateWo alterRow(updateIf(1==1)) ~> alterRowUpdate",
						"selInsertWo sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          WORKORDER_ID as integer,",
						"          WONUM as string,",
						"          PARENT as string,",
						"          GOVTWONUM as string,",
						"          ORGANIZATION_ID as integer,",
						"          SITE_ID as integer,",
						"          LOCATION_ID as integer,",
						"          ASSETNUM as string,",
						"          STATUS as string,",
						"          JPNUM as string,",
						"          WORKTYPE as string,",
						"          TASKID as integer,",
						"          ISTASK as integer,",
						"          DESCRIPTION as string,",
						"          PLUSCJPREVNUM as integer,",
						"          WOPRIORITY as integer,",
						"          CHANGEDATE as timestamp,",
						"          STATUSDATE as timestamp,",
						"          CHANGEBY as string,",
						"          PMDUEDATE as date,",
						"          TARGSTARTDATE as timestamp,",
						"          TARGCOMPDATE as timestamp,",
						"          REPORTDATE as timestamp,",
						"          RESPONDBY as timestamp,",
						"          ACTLABHRS as decimal(18,9),",
						"          ACTSTART as timestamp,",
						"          ACTFINISH as timestamp,",
						"          ACTINTLABHRS as decimal(18,9),",
						"          ESTDUR as decimal(18,9),",
						"          WOGROUP as string,",
						"          PERSONGROUP as string,",
						"          OWNERGROUP as string,",
						"          PLUSCFREQUENCY as integer,",
						"          PLUSCFREQUNIT as string,",
						"          PMNEXTDUEDATE as date,",
						"          PMNUM as string,",
						"          EFFECTIVE_DT as timestamp,",
						"          SRC_TYPE_HASH_KEY as string",
						"     ),",
						"     deletable:false,",
						"     insertable:true,",
						"     updateable:false,",
						"     upsertable:false,",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 2,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          WORKORDER_ID,",
						"          WONUM,",
						"          PARENT,",
						"          GOVTWONUM,",
						"          ORGANIZATION_ID,",
						"          SITE_ID,",
						"          LOCATION_ID,",
						"          ASSETNUM,",
						"          STATUS,",
						"          JPNUM,",
						"          WORKTYPE,",
						"          TASKID,",
						"          ISTASK,",
						"          DESCRIPTION,",
						"          PLUSCJPREVNUM,",
						"          WOPRIORITY,",
						"          CHANGEDATE,",
						"          STATUSDATE,",
						"          CHANGEBY,",
						"          PMDUEDATE,",
						"          TARGSTARTDATE,",
						"          TARGCOMPDATE,",
						"          REPORTDATE,",
						"          RESPONDBY,",
						"          ACTLABHRS,",
						"          ACTSTART,",
						"          ACTFINISH,",
						"          ACTINTLABHRS,",
						"          ESTDUR,",
						"          WOGROUP,",
						"          PERSONGROUP,",
						"          OWNERGROUP,",
						"          PLUSCFREQUENCY,",
						"          PLUSCFREQUNIT,",
						"          PMNEXTDUEDATE,",
						"          PMNUM,",
						"          EFFECTIVE_DT,",
						"          SRC_TYPE_HASH_KEY",
						"     )) ~> sinkInsertWorkorder",
						"alterRowUpdate sink(allowSchemaDrift: true,",
						"     validateSchema: false,",
						"     input(",
						"          WORKORDER_ID as integer,",
						"          WONUM as string,",
						"          PARENT as string,",
						"          GOVTWONUM as string,",
						"          ORGANIZATION_ID as integer,",
						"          SITE_ID as integer,",
						"          LOCATION_ID as integer,",
						"          ASSETNUM as string,",
						"          STATUS as string,",
						"          JPNUM as string,",
						"          WORKTYPE as string,",
						"          TASKID as integer,",
						"          ISTASK as integer,",
						"          DESCRIPTION as string,",
						"          PLUSCJPREVNUM as integer,",
						"          WOPRIORITY as integer,",
						"          CHANGEDATE as timestamp,",
						"          STATUSDATE as timestamp,",
						"          CHANGEBY as string,",
						"          PMDUEDATE as date,",
						"          TARGSTARTDATE as timestamp,",
						"          TARGCOMPDATE as timestamp,",
						"          REPORTDATE as timestamp,",
						"          RESPONDBY as timestamp,",
						"          ACTLABHRS as decimal(18,9),",
						"          ACTSTART as timestamp,",
						"          ACTFINISH as timestamp,",
						"          ACTINTLABHRS as decimal(18,9),",
						"          ESTDUR as decimal(18,9),",
						"          WOGROUP as string,",
						"          PERSONGROUP as string,",
						"          OWNERGROUP as string,",
						"          PLUSCFREQUENCY as integer,",
						"          PLUSCFREQUNIT as string,",
						"          PMNEXTDUEDATE as date,",
						"          PMNUM as string,",
						"          EFFECTIVE_DT as timestamp,",
						"          SRC_TYPE_HASH_KEY as string",
						"     ),",
						"     deletable:false,",
						"     insertable:false,",
						"     updateable:true,",
						"     upsertable:false,",
						"     keys:['WONUM','SITE_ID'],",
						"     format: 'table',",
						"     staged: true,",
						"     allowCopyCommand: true,",
						"     skipDuplicateMapInputs: true,",
						"     skipDuplicateMapOutputs: true,",
						"     saveOrder: 1,",
						"     errorHandlingOption: 'stopOnFirstError',",
						"     mapColumn(",
						"          WORKORDER_ID = ExistWORKORDER_ID,",
						"          WONUM = ExistWONUM,",
						"          PARENT,",
						"          GOVTWONUM,",
						"          ORGANIZATION_ID,",
						"          SITE_ID = ExistSITE_ID,",
						"          LOCATION_ID,",
						"          ASSETNUM,",
						"          STATUS,",
						"          JPNUM,",
						"          WORKTYPE,",
						"          TASKID,",
						"          ISTASK,",
						"          DESCRIPTION,",
						"          PLUSCJPREVNUM,",
						"          WOPRIORITY,",
						"          CHANGEDATE,",
						"          STATUSDATE,",
						"          CHANGEBY,",
						"          PMDUEDATE,",
						"          TARGSTARTDATE,",
						"          TARGCOMPDATE,",
						"          REPORTDATE,",
						"          RESPONDBY,",
						"          ACTLABHRS,",
						"          ACTSTART,",
						"          ACTFINISH,",
						"          ACTINTLABHRS,",
						"          ESTDUR,",
						"          WOGROUP,",
						"          PERSONGROUP,",
						"          OWNERGROUP,",
						"          PLUSCFREQUENCY,",
						"          PLUSCFREQUNIT,",
						"          PMNEXTDUEDATE,",
						"          PMNUM,",
						"          EFFECTIVE_DT,",
						"          SRC_TYPE_HASH_KEY",
						"     )) ~> sinkUpdateWorkorder"
					]
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Asset_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Asset_Dim_pln",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Asset_Dim_df",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"SrcstgAssetRead": {},
									"srcAssetSiteRefRd": {},
									"AssetExistingRowsRd": {},
									"MaxKey": {},
									"sinkAssetLd": {},
									"sinkAssetUpdate": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Asset_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Asset_Dim_pln",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Asset_Dim_df1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"SrcstgAssetRead": {},
									"srcAssetSiteRefRd": {},
									"AssetExistingRowsRd": {},
									"MaxKey": {},
									"sinkAssetLd": {},
									"sinkAssetUpdate": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Jobplan_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_JobPlan_Dim",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Jobplan_Dim_df2",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcJobPlanRead": {},
									"RefOrgJP": {},
									"JobplanExistingRowRd": {},
									"MaxKey": {},
									"sinkJPInitLd": {},
									"sinkJobPlanUpdate": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-08-26T16:44:27Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Jobplan_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_JobPlan_Dim",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Jobplan_Dim_df21",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcJobPlanRead": {},
									"RefOrgJP": {},
									"JobplanExistingRowRd": {},
									"MaxKey": {},
									"sinkJPInitLd": {},
									"sinkJobPlanUpdate": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-08-26T16:44:27Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Labtrans_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Labtrans_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.01:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Labtrans_Fact_df",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcStgLabtransRd": {},
									"OrgSiteRef": {},
									"LocationRef": {},
									"CraftRef": {},
									"WorkorderRef": {},
									"MaxKey": {},
									"ExistRows": {},
									"sinkLabtrans": {},
									"sinkUpdateLabtrans": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:26Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Labtrans_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Labtrans_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.01:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Labtrans_Fact_df1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcStgLabtransRd": {},
									"OrgSiteRef": {},
									"LocationRef": {},
									"CraftRef": {},
									"WorkorderRef": {},
									"MaxKey": {},
									"ExistRows": {},
									"sinkLabtrans": {},
									"sinkUpdateLabtrans": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:26Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Locations_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Locations_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.01:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Locations_Dim_df",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcLocationsRead": {},
									"OrgSiteRefRead": {},
									"ExistingRecordsRead": {},
									"MaxKey": {},
									"sinkLocationsLoad": {},
									"sinkUpdateItem": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Locations_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Locations_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.01:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Locations_Dim_df1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcLocationsRead": {},
									"OrgSiteRefRead": {},
									"ExistingRecordsRead": {},
									"MaxKey": {},
									"sinkLocationsLoad": {},
									"sinkUpdateItem": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Operation_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Operation_Fact_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.01:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_OperationLdFact_df",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcOperationRead": {},
									"OrgSiteRefRd": {},
									"AssetRefRd": {},
									"PersonRefRd": {},
									"JobplanRefRd": {},
									"PerGrpRefRd": {},
									"LocationRefRd": {},
									"MaxKey": {},
									"OpsExistingRows": {},
									"srcWorkOrderReadRef": {},
									"JobplanNullSiteRd": {},
									"sinkOpsInsert": {},
									"sinkOperationUpdate": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-07-11T10:53:43Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Operation_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Operation_Fact_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.01:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_OperationLdFact_df1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcOperationRead": {},
									"OrgSiteRefRd": {},
									"AssetRefRd": {},
									"PersonRefRd": {},
									"JobplanRefRd": {},
									"PerGrpRefRd": {},
									"LocationRefRd": {},
									"MaxKey": {},
									"OpsExistingRows": {},
									"srcWorkOrderReadRef": {},
									"JobplanNullSiteRd": {},
									"sinkOpsInsert": {},
									"sinkOperationUpdate": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-07-11T10:53:43Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Person_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Person_Dim",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Person_Dim_df",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcPersonLd": {},
									"srcPersonSiteRefRd": {},
									"PersonExistRowRd": {},
									"MaxKey": {},
									"sinkPersonLd": {},
									"sinkPersonUpdate": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_Person_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_Person_Dim",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dp_Person_Dim_df1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcPersonLd": {},
									"srcPersonSiteRefRd": {},
									"PersonExistRowRd": {},
									"MaxKey": {},
									"sinkPersonLd": {},
									"sinkPersonUpdate": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine",
							"sourceStagingConcurrency": 1
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMDW"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:21Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_RawStg_Asset_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "src_RawStg_Asset_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:20:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dpRawStgAsset_df",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcRawStgAsset": {
										"InputPath": {
											"value": "@pipeline().globalParameters.Maximorelativeinputpath",
											"type": "Expression"
										}
									},
									"sinkRawStgAsset": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMSTG"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_RawStg_Asset_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "src_RawStg_Asset_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:20:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dpRawStgAsset_df1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcRawStgAsset": {
										"InputPath": {
											"value": "@pipeline().globalParameters.Maximorelativeinputpath",
											"type": "Expression"
										}
									},
									"sinkRawStgAsset": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMSTG"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_RawStg_JobPlan_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dpRawStgJobPlan_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dpRawStgJobPlan_df",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcRawStgJobplan": {
										"InputPath": {
											"value": "@pipeline().globalParameters.Maximorelativeinputpath",
											"type": "Expression"
										}
									},
									"sinkRawStgJobplan": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMSTG"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_RawStg_JobPlan_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dpRawStgJobPlan_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.00:10:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dpRawStgJobPlan_df1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"srcRawStgJobplan": {
										"InputPath": {
											"value": "@pipeline().globalParameters.Maximorelativeinputpath",
											"type": "Expression"
										}
									},
									"sinkRawStgJobplan": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMSTG"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:20Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_RawStg_Labtrans_pln')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_RawStg_Labtrans_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.01:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dpRawStgLabtrans_df",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"RawSrcLabTrans": {
										"InputPath": {
											"value": "@pipeline().globalParameters.Maximorelativeinputpath",
											"type": "Expression"
										}
									},
									"sinkStgLabTrans": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMSTG"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:22Z"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/dp_RawStg_Labtrans_pln1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "dp_RawStg_Labtrans_df",
						"type": "ExecuteDataFlow",
						"dependsOn": [],
						"policy": {
							"timeout": "0.01:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"dataflow": {
								"referenceName": "dpRawStgLabtrans_df1",
								"type": "DataFlowReference",
								"parameters": {},
								"datasetParameters": {
									"RawSrcLabTrans": {
										"InputPath": {
											"value": "@pipeline().globalParameters.Maximorelativeinputpath",
											"type": "Expression"
										}
									},
									"sinkStgLabTrans": {}
								}
							},
							"staging": {
								"linkedService": {
									"referenceName": "AzureDataLakeStorage1",
									"type": "LinkedServiceReference"
								},
								"folderPath": {
									"value": "@pipeline().globalParameters.MaximoLog",
									"type": "Expression"
								}
							},
							"compute": {
								"coreCount": 8,
								"computeType": "General"
							},
							"traceLevel": "Fine"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"folder": {
					"name": "MXMSTG"
				},
				"annotations": [],
				"lastPublishTime": "2022-09-29T07:13:22Z"
			},
			"dependsOn": []
		}
	]
}